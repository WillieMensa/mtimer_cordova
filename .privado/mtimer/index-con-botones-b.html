<!DOCTYPE html>
<html lang="sp">
<head>
<!-- 
	index-con-botones-b.html
		numeros svg

	Timer para contar minutos:segundos restantes
	basado en https://www.w3schools.com/howto/howto_js_countdown.asp
	tutorial grilla  https://developer.mozilla.org/en-US/docs/Learn/CSS/CSS_layout/Grids	

	Incluir
		Pausar
		volver a pantalla inicio

	Modificar el ingreso del tiempo para el timer
		usar flecha arriba/abajo para incrementar/decrementar tiempo

	nombres utilizados
	minutos	id texto minutos
	segundos	id texto segundos


-->

	<title>Temporizador</title> 

	<meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>


<style>

	@font-face {
			font-family: 'balooregular';
			src: url('baloo-regular-webfont.woff2') format('woff2'),
					 url('baloo-regular-webfont.woff') format('woff');
			font-weight: normal;
			font-style: normal;
	}


	@media screen and (max-width:400px) {
		body {
			background-color: #440;
			max-width: 400px;
			max-height: 300px;
		}
		.setButton {
			font-size:  3em;
		}
	}

	@media screen and (max-width:640px)  and (min-width:400px) {
		body {
			background-color: #600;
			max-width: 500px;
			max-height: 300px;
		}
		.setButton {
			font-size:  4em;
		}
	}

	@media screen and (max-width:1024px) and (min-width:640px) {
		body {
			background-color: #060;
			max-width: 800px;
			max-height: 500px;
		}
		.setButton {
			font-size:  6em;
		}
	}

	@media screen and (min-width:1024px) {
		body {
			background-color: #006;
			max-width: 1000px;
			max-height: 600px;
		}
		.setButton {
			font-size:  8em;
		}
	}

	
	* {
		box-sizing: border-box;
	}


	body {
	  margin: 0 auto;
	  font-family: 'balooregular;
		color: #def;
		padding:0px;	
	}


	div {
		border-style: solid;
		border-width: 1px;
	  border-color: gray;		
		text-align: center;
		vertical-align: middle;
	}


	/* para centrar los iconos 
	.cross-center {
			/* Centramos verticalmente el ícono con el texto 
			display     : flex;
			align-items : center;
	}
	*/

	h2 {
    font-family: 'balooregular';
		font-size: 12px;

	}


	.grossNum {
		padding: 0px;	
		margin: 0px;	
		text-align: center;
    font-family: 'balooregular';
		/*	line-height: 100%;	*/
		color: #ace;

	}

	.digitos {
		margin-top: 0px;
		text-align: center;
    font-family: 'balooregular';
		font-size: 16em;
	}

	.setButton {
		width: 100px;
		padding: 0px;	
		/*	margin-top: -4px;		*/
		border: 0px;	
		background:#011;
		text-align: center;
		line-height: 100%;
		color: #ace;

	}

	.small {  color: #eee; font-family: 'balooregular'; font-size: 1em; }
	.heavy { font-family: 'balooregular', cursive; font-size: 40px; }
	.auxiliar { fill:gray; stroke:#444;stroke-width:1;opacity:0.8; }

</style>

</head>





<body onload="init()" id="cuerpo">

<div class="container-fluid">
	<div class="row">
		<div class="col-sm-3">
			<br><img src="logomensa.png" width="100" height="100" border="0" alt="">
		</div>
		<div class="col-sm-6" >
			<p id="medidas" class= "small"></p>
		</div>
		<div class="col-sm-3" >

			<!-- aqui seleccionamos idioma -->
			<div class="dropdown">
				<button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
					Idioma
				</button>

				<ul class="dropdown-menu">
					<li><a href="#">Espa&#241ol</a> </li>
					<li><a href="#">English</a>     </li>
					<li><a href="#">Deutsch</a>     </li>
				</ul>

		  </div>

		</div>
	</div>


	<div class="row">
	<!-- fila para digitos del temporizador y botones de ajuste de tiempo -->
		<div class="col-sm-5" >
			<p><button id="incMinu" class="btn btn-dark setButton" onclick="ajustaMinu(1);"> &#9650; </button></p>
			<!-- 
				desecho el uso de texto comun por las dificultades para controlar espacios
				<p id="minutos" class="grossNum">00</p> 
			-->
			<!-- digitos del timer -->
			<svg 
				xmlns="http://www.w3.org/2000/svg" 
				width="100%" height="100%"
				viewBox="0 0 270 200"
				>
				<rect x="0" y="0" width="100%" height="100%" style="stroke-width:1; stroke:#ccc; fill:#202"/>
				<text
					id="minutos"
					transform="translate(00,170)"
					x="00"
					y="00"
					class = "digitos"
					fill="#888" >00
				</text>
			</svg>

			<p><button id="decMinu" type="button" class="btn btn-dark setButton" onclick="ajustaMinu(-1);">&#9660;</button></p>
		</div>

		<div class="col-sm-2" >
			<p>&nbsp;</p>
			<button id="inicia" type="button" class="btn setButton" onclick="fijaTiempo(),startButton();">
				<span class="glyphicon glyphicon-play"></span>
			</button>

			<!-- <p id="dosPuntos" class="grossNum">:</p> -->
			<button id="pausa" type="button" class="btn btn-dark setButton" onclick="detiene();">
				<span class="glyphicon glyphicon-pause"></span>
			</button>

			<button id="detiene" type="button" class="btn btn-dark setButton" onclick="detiene();">
				<span class="glyphicon glyphicon-stop"></span>
			</button>


		</div>
		<div class="col-sm-5" >
			<button id="incSegu" type="button" class="btn btn-dark setButton" onclick="ajustaSegu(1);">&#9650;</button>
			<!-- <p id="segundos" class="grossNum">00</p> -->
			<svg 
				xmlns="http://www.w3.org/2000/svg" 
				width="100%" height="100%"
				viewBox="0 0 270 200"
				>
				<rect x="0" y="0" width="100%" height="100%" style="stroke-width:1; stroke:#ccc; fill:#202"/>
				<text
					id="segundos"
					transform="translate(00,170)"
					x="00"
					y="00"
					class = "digitos"
					fill="#888" >00
				</text>
			</svg>

			<button id="decSegu" type="button" class="btn btn-dark setButton" onclick="ajustaSegu(-1);">&#9660;</button>

		</div>
	</div>


</div>




<!-- inicio de los scripts -->
<script type="text/javascript">

//	-------------------------
//	Constantes
//	-------------------------
const
	RENDERER_W = 1000,			//	1000,
	RENDERER_H = 600,
	FONDO_APP = 0x001111,		//	 "#ffc",
	VERSION	= "0.8.0",			//	version inicial
	FONDO_AYUDA = 0x008cff,
	FONT_NIVEL1 = "balooregular"	//	titulo:	"Bangers",	"Luckiest Guy",	"titan_one", "Sigmar One"
	FONT_NIVEL2 = "bangersregular",	//	botones: "Bangers",	//	"Sigmar One",
	FONT_NIVEL3 = "sriracharegular",		//	textos:
	//	DEBUG = false;
	DEBUG = true,				//	depurar o no depurar
	minutosOff = 150,		//	pos izq txt min
	foo = 0;

var	
	nDist = undefined,		//	tiempo fijado en el timer en milisegundos
	cMin = "20", 
	cSeg = "00",					//	minutos y segundos en formato texto
	stopTime = undefined;	//	el horario de finalizacion




function init() {
	fijaTiempo();
	if (DEBUG)
	{
		var	screenWidth = window.innerWidth,
			screenHeight = window.innerHeight;
			document.getElementById("medidas").innerHTML = 
			"ancho: " + screenWidth + "; alto: " + screenHeight ;
	}
}




function ajustaMinu( nDir ) {
	//	ajustar valores iniciales del timer
	var nMin = undefined;
	console.log ("nMin, cMin: " + nMin + ", " + cMin);
	nMin = parseInt( cMin ) + nDir;
	nMin = ((nMin < 0) ? 0 : ((nMin > 60) ? 60 : nMin ) );	
	cMin = ("00" + nMin).slice(-2);
	document.getElementById("minutos").innerHTML = cMin;
}


function ajustaSegu( nDir ) {
	//	ajustar valores iniciales del timer
	var nSeg = undefined;

	console.log ("nSeg, cSeg: " + nSeg + ", " + cSeg);

	nSeg = parseInt( cSeg ) + nDir;
	nSeg = ((nSeg < 0) ? 0 : ((nSeg > 60) ? 60 : nSeg ) );	
	cSeg = ("00" + nSeg).slice(-2);
	document.getElementById("segundos").innerHTML = cSeg;
}



function fijaTiempo() {
	document.getElementById("minutos").innerHTML = cMin;
  document.getElementById("segundos").innerHTML = cSeg;

}



function startButton() {
	nDist = cMin * 60000 + cSeg * 1000;
	console.log( "nDist: " + nDist );

	stopTime = new Date().getTime() + nDist + 10;		//	devuelve la hora de finalizacion
		//	agrego 2 milisegundos para compensar tiempo de calculo previo 
		//	caso contrario no muestra el primer momento correctamente

	console.log("Tiempo inicial, stopTime: " + cMin + ":" + cSeg + ", " + stopTime);
	iniciaReloj();

}


//	boton para iniciar timer
function iniciaReloj() {
	ocultaBotones();

	document.getElementById('detiene').style.visibility='visible';


	//	setInterval() Ejecuta una función o un fragmento de código de forma repetitiva cada vez 
	//	que termina el periodo de tiempo determinado. Devuelve un ID de proceso.
	//	en este caso actualiza la cuenta regresiva cada segundo
	var x = setInterval(function() {

		// Get todays date and time
		var now = new Date().getTime();

		//	console.log( "stopTime, now, cDist antes: " + stopTime +", " + now +", " + cDist )

		// Find the distance between now and the count down date
		nDist = stopTime - now;
		//	console.log( "nDist, stopTime, now: " + nDist +", "+ stopTime +", "+ now );

		actualizaReloj();

			
		// If the count down is over, write some text 
		if (nDist < 10 ) {
			clearInterval(x);
			//	aqui poner aviso: una alarma de sonido, parpadeo y/o similar
		
			// creamos el objeto audio
			var audioElement = document.createElement('audio');
			// indicamos el archivo de audio a cargar
			audioElement.setAttribute('src', 'psicosis.mp3');
			//	Si deseamos que una vez cargado empieze a sonar...
			//	audioElement.setAttribute('autoplay', 'autoplay');			 
			//	iniciamos el audio
			audioElement.play();
		}
	}, 1000);
}



function actualizaReloj() {
		// Time calculations for minutes and seconds
		cMin = ("00" + Math.floor((nDist % (3600000)) / 60000 )).slice(-2);
		cSeg = ("00" + Math.floor((nDist % 60000 ) / 1000)).slice(-2);

		// Output the result 
		//	<!-- document.getElementById("minutos").innerHTML = strMin.slice(-2); -->
		document.getElementById("minutos").innerHTML = cMin;
		document.getElementById("segundos").innerHTML = cSeg;

		//	console.log( "cDist, : " +  cDist + ", " + strMin.slice(-2) + ":" + strSeg.slice(-2));
		//	console.log( strSeg + ", " + strSeg.length + ", " + strSeg.slice(-2));
}


//--------------------
// hidden all button
//--------------------
function ocultaBotones() {
	//	oculta botones innecesarios mientras funciona el timer
	document.getElementById('incMinu').style.visibility='hidden';
	document.getElementById('decMinu').style.visibility='hidden';
	document.getElementById('inicia').style.visibility='hidden';
	document.getElementById('detiene').style.visibility='hidden';
	document.getElementById('incSegu').style.visibility='hidden';
	document.getElementById('decSegu').style.visibility='hidden';

}


//-------------------------------------------------------------------
// adaptacion idiomas
//-------------------------------------------------------------------
function initLanguage()		//	para adaptar a diferentes idiomas
{
	var sysLang = "sp";

	if(sysLang == "en" || sysLang == "en") { //	ingles
		txtAyuda	= "Help";
		txtJugar = "Play",
		txtAcerca = "About",
		txtDescAcerca =
			'About MENSA timer version ' + VERSION  + '\n' +
			'Is a timer developed by Willie Verger Ingenuity Games \n' + 
			'Support: info@ingverger.com.ar\n' +
			'Web: ingverger.com.ar\n' +
			'\n';
		txtDescAyuda = 
			'How does it work? \n' +
			'There is a set of cards, each with an image, placed in such a way \n' +
			'The game ends when all pairs have been found. \n',
			txtFin = "Well resolved!\nCongratulations! ",
			txtTiempo = "Elapsed time: ";
		finishText = "Congratulation";
		levelText = "Level";
	} else if(sysLang == "de" || sysLang == "de") { //	aleman
		txtAyuda	= "Hilfe";
		txtJugar = "Spielen",
		txtAcerca = "Über",
		txtDificu = "Schwierigkeit";
		txtDescAcerca =
			'Über MEMORIOSO Version ' + VERSION  + '\n' +
			'Es ist ein von Willie Verger Ingenuity Games \n' + 
			'entwickeltes Spiel, um Konzentration und \n' +
			'Gedächtnis zu trainieren. \n' +
			'Unterstützung: info@ingverger.com.ar\n' +
			'Web: ingverger.com.ar\n' +
			'\n';
		txtDescAyuda = 
			'Was ist es?\n' +
			'MEMORIOSO ist ein Spiel der Konzentration und des Gedächtnisses.\n' +
			'Es gibt eine Reihe von Karten mit jeweils einem Bild so platziert,\n' +
			'dass seine Vorderseite nicht sichtbar ist.\n' +
			'Es gibt zwei Registerkarten für jedes Bild. Das Spiel ist zu finden\n' +
			'die Paare gleicher Bilder.\n' +
			'Wenn Sie auf ein Bild klicken, wird es umgedreht.\n' +
			'Es werden zwei aufeinander folgende Karten ausgewählt. Wenn sie \n' +
			'sich als gleich herausstellen, werden sie vom Board entfernt. \n' +
			'Wenn sie unterschiedlich sind, kehren sie zur ursprünglichen \n' +
			'Position zurück.\n' +
			'Das Spiel endet, wenn alle Paare gefunden wurden.\n',
		txtFin = "Gut gelöst!\nGlückwunsch! ",
		txtTiempo = "Verstrichene Zeit: ";
		noSolutionText = "keine losung ";
		nextText = "Nächste";
		finishText = "Glückwunsch!";
		levelText = "Niveau";
	}
}



//----------------------------------------------
//	asignacion de valores a variables basados en medidas de pantalla
//----------------------------------------------
function initScreenVariable()
{
	var screenWidth = 0, screenHeight = 0;	// ancho y alto de pantallla

	var maxStageX = 1000;
	var maxStageY = 800;
	var maxCellSize = 64;

	var midStageX = 800;
	var midStageY = 600;
	var midCellSize = 50;		//	var midCellSize = 32;

	var miniStageX = 600;
	var miniStageY = 400;
	var miniCellSize = 36;	// 24;

	var microStageX = 400;
	var microStageY = 300;
	var microCellSize = 32;	// 20;

	//----------------------------------------------------------------------
	// Window size and scrolling:
	// URL: http://www.howtocreate.co.uk/tutorials/javascript/browserwindow
	//----------------------------------------------------------------------
	screenWidth = window.innerWidth;
	screenHeight = window.innerHeight;

	SCREEN_X = screenWidth;
	SCREEN_Y = screenHeight;

	//	STAGE_X = ((screenWidth%2)? (screenWidth-1):screenWidth) - microCellSize*2;
	STAGE_X = Math.floor(screenWidth*0.95);


	//	if(STAGE_X > maxStageX) STAGE_X = maxStageX;
	//	if(STAGE_X < microStageX) STAGE_X = microStageX;
	STAGE_OFFSET_X = Math.floor((screenWidth - STAGE_X)/2);
	if(STAGE_OFFSET_X < microCellSize) STAGE_OFFSET_X = microCellSize;

	//	STAGE_Y = ((screenHeight%2)?(screenHeight-1):screenHeight) - microCellSize*2;
	STAGE_Y = Math.floor(screenHeight*0.90);

	if(STAGE_Y > maxStageY) STAGE_Y = maxStageY;
	if(STAGE_Y < microStageY) STAGE_Y = microStageY;
	STAGE_OFFSET_Y = Math.floor((screenHeight - STAGE_Y)/2);
	if(STAGE_OFFSET_Y < microCellSize) STAGE_OFFSET_Y = microCellSize;


	if (DEBUG)	{	console.log("SCREEN_X: " + SCREEN_X + ' SCREEN_Y: ' + SCREEN_Y ); }


	console.log( 'Parametros de pantalla'	);
	console.log( 'SCREEN_X: ' +		SCREEN_X       );
	console.log( 'SCREEN_Y: ' + 		SCREEN_Y       );
	console.log( 'STAGE_X: ' + 		STAGE_X        );
	console.log( 'STAGE_OFFSET_X: ' + 	STAGE_OFFSET_X );
	console.log( 'STAGE_Y: ' + 		STAGE_Y        );
	console.log( 'STAGE_OFFSET_Y: ' +  	STAGE_OFFSET_Y );

}

//----------------------------------------------
// initial screen position and background color
//----------------------------------------------
function initScreenPosColor()
{
	document.getElementById('logomensa').style.cssText =		"top: 210 px; left: 010 px; position: absolute;";
	document.getElementById('botonAjustes').style.cssText = "top: 400 px; left: 010 px; position: absolute;";
	document.getElementById('botonFijaTpo').style.cssText = "top: 500 px; left: 010 px; position: absolute;";
	document.getElementById('botonReset').style.cssText =		"top: 600 px; left: 010 px; position: absolute;";
	document.getElementById('botonInicio').style.cssText =	"top: 700 px; left: 010 px; position: absolute;";

	document.body.style.background = COLOR_FONDO; //body background color
}



</script>

</body>
</html>

